:8000 {
    cache
    gzip
    rewrite {
        if {file} not favicon.ico
        to {path} {path}/ /index.html
    }
}

:8000/discord {
    cache
    redir https://discordapp.com/invite/eNkDNRh
    nobots "1G.gzip" {
        regexp "^[Bb]ot"
    }
}

:8000/handbook {
    cache
    gzip
    root ./handbook/public
}

:8000/secure {
    cache
    gzip
    root ./secure
    basicauth / admin pass
    nobots "1G.gzip" {
        regexp "^[Bb]ot"
    }
}

:8000/files {
    cache
    gzip
    s3browser {
		#key ADDKEYHERE
		#secret ADDSECRETHERE
		bucket gcs.unnamed.group
		endpoint storage.googleapis.com
		secure false
		refresh 1m
		debug false
	}
	proxy / http://gcs.unnamed.group {
		header_upstream Host gcs.unnamed.group
	}
    redir 301 {
        if {uri} not_ends_with /
        if {file} not_has .
        / {uri}/
    }
    nobots "1G.gzip" {
        regexp "^[Bb]ot"
    }
}

:8000/api {
    cache
    root ./api
    realip 0.0.0.0/0
    ratelimit * / 2 3 second
    nobots "1G.gzip" {
        regexp "^[Bb]ot"
    }
}